{"ast":null,"code":"import { ChangeDetectorRef } from '@angular/core';\nimport { timer } from 'rxjs';\nimport { Subscription } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/cdk/layout\";\nimport * as i2 from \"../../core/services/spinner.service\";\nimport * as i3 from \"src/app/core/services/auth.service\";\nimport * as i4 from \"src/app/core/guards/auth.guard\";\nimport * as i5 from \"../../core/services/reserva.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/sidenav\";\nimport * as i9 from \"@angular/material/icon\";\nimport * as i10 from \"@angular/material/toolbar\";\nimport * as i11 from \"@angular/material/button\";\nimport * as i12 from \"@angular/material/list\";\nimport * as i13 from \"@angular/material/core\";\nimport * as i14 from \"@angular/material/divider\";\nimport * as i15 from \"@angular/material/progress-bar\";\nimport * as i16 from \"@angular/material/menu\";\nimport * as i17 from \"@angular/material/tooltip\";\nimport * as i18 from \"@angular/material/badge\";\nimport * as i19 from \"@angular/flex-layout/extended\";\n\nfunction LayoutComponent_span_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Tienes \", ctx_r1.notificacionesCount, \" citas para hoy\");\n  }\n}\n\nfunction LayoutComponent_span_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"No tienes citas pendientes\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return [\"/customers\"];\n};\n\nfunction LayoutComponent_a_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 18)(1, \"mat-icon\", 19);\n    i0.ɵɵtext(2, \"people\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\", 20);\n    i0.ɵɵtext(4, \" Pacientes \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c0));\n  }\n}\n\nconst _c1 = function () {\n  return [\"/typography\"];\n};\n\nfunction LayoutComponent_a_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 18)(1, \"mat-icon\", 19);\n    i0.ɵɵtext(2, \"calendar_today\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\", 20);\n    i0.ɵɵtext(4, \" Reservas \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c1));\n  }\n}\n\nconst _c2 = function () {\n  return [\"/icons\"];\n};\n\nfunction LayoutComponent_a_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 18)(1, \"mat-icon\", 19);\n    i0.ɵɵtext(2, \"assessment\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\", 20);\n    i0.ɵɵtext(4, \" Reportes \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c2));\n  }\n}\n\nconst _c3 = function () {\n  return [\"/users\"];\n};\n\nfunction LayoutComponent_a_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 18)(1, \"mat-icon\", 19);\n    i0.ɵɵtext(2, \"manage_accounts\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\", 20);\n    i0.ɵɵtext(4, \" Usuarios \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c3));\n  }\n}\n\nfunction LayoutComponent_mat_progress_bar_52_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 26);\n  }\n}\n\nconst _c4 = function () {\n  return [\"/\"];\n};\n\nconst _c5 = function () {\n  return [\"/dashboard\"];\n};\n\nexport class LayoutComponent {\n  constructor(changeDetectorRef, media, spinnerService, authService, authGuard, reservaService) {\n    this.changeDetectorRef = changeDetectorRef;\n    this.media = media;\n    this.spinnerService = spinnerService;\n    this.authService = authService;\n    this.authGuard = authGuard;\n    this.reservaService = reservaService;\n    this.showSpinner = false;\n    this.userName = \"\";\n    this.isAdmin = false;\n    this.notificacionesCount = 0;\n    this.autoLogoutSubscription = new Subscription();\n    this.mobileQuery = this.media.matchMedia('(max-width: 1000px)');\n\n    this._mobileQueryListener = () => changeDetectorRef.detectChanges(); // tslint:disable-next-line: deprecation\n\n\n    this.mobileQuery.addListener(this._mobileQueryListener);\n  }\n\n  ngOnInit() {\n    this.currentUser = this.authService.getCurrentUser();\n    const user = this.authService.getCurrentUser();\n    this.isAdmin = user.isAdmin;\n    this.userName = user.fullName; // Auto log-out subscription\n\n    const timer$ = timer(2000, 5000);\n    this.autoLogoutSubscription = timer$.subscribe(() => {\n      this.authGuard.canActivate();\n    });\n    this.cargarNotificaciones();\n  }\n\n  ngOnDestroy() {\n    // tslint:disable-next-line: deprecation\n    this.mobileQuery.removeListener(this._mobileQueryListener);\n    this.autoLogoutSubscription.unsubscribe();\n  }\n\n  ngAfterViewInit() {\n    this.changeDetectorRef.detectChanges();\n  }\n\n  onLogout() {\n    this.authService.logout(); // Esta función ya se encarga de borrar el localStorage \n    // y redirigir al login.\n  }\n\n  cargarNotificaciones() {\n    this.reservaService.getConteoHoy().subscribe(data => {\n      this.notificacionesCount = data.total;\n      console.log('Citas para hoy:', this.notificacionesCount);\n    }, error => console.error('Error cargando notificaciones', error));\n  }\n\n  get esAdmin() {\n    return this.currentUser?.usuario?.rol === 'ADMIN';\n  }\n\n  get esOperador() {\n    return this.currentUser?.usuario?.rol === 'OPERADOR';\n  }\n\n  get esCalificador() {\n    return this.currentUser?.usuario?.rol === 'CALIFICADOR';\n  }\n\n}\n\nLayoutComponent.ɵfac = function LayoutComponent_Factory(t) {\n  return new (t || LayoutComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i1.MediaMatcher), i0.ɵɵdirectiveInject(i2.SpinnerService), i0.ɵɵdirectiveInject(i3.AuthenticationService), i0.ɵɵdirectiveInject(i4.AuthGuard), i0.ɵɵdirectiveInject(i5.ReservaService));\n};\n\nLayoutComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LayoutComponent,\n  selectors: [[\"app-layout\"]],\n  decls: 55,\n  vars: 25,\n  consts: [[1, \"navbar-container\"], [1, \"navbar\"], [\"mat-icon-button\", \"\", 3, \"click\"], [\"matTooltip\", \"Home\", 1, \"navbar-brand\", 3, \"routerLink\"], [1, \"navbar-spacer\"], [\"mat-icon-button\", \"\", 3, \"matMenuTriggerFor\"], [\"matBadgeColor\", \"warn\", 3, \"matBadge\", \"matBadgeHidden\"], [\"xPosition\", \"before\", \"yPosition\", \"above\", 3, \"overlapTrigger\"], [\"notificationMenu\", \"matMenu\"], [\"mat-menu-item\", \"\", \"routerLink\", \"/dashboard\"], [4, \"ngIf\"], [\"mat-button\", \"\", 3, \"matMenuTriggerFor\"], [\"fxShow\", \"\", \"fxHide.xs\", \"\"], [\"userMenu\", \"matMenu\"], [\"mat-menu-item\", \"\", 3, \"click\"], [1, \"navbar-sidenav-container\"], [\"fixedTopGap\", \"56\", 1, \"sidenav\", 3, \"opened\", \"mode\", \"fixedInViewport\"], [\"snav\", \"\"], [\"mat-list-item\", \"\", \"routerLinkActive\", \"active\", 3, \"routerLink\"], [\"mat-list-icon\", \"\"], [\"mat-line\", \"\"], [\"mat-list-item\", \"\", \"routerLinkActive\", \"active\", 3, \"routerLink\", 4, \"ngIf\"], [\"mat-list-item\", \"\", 2, \"cursor\", \"pointer\", 3, \"click\"], [1, \"sidenav-content\"], [1, \"progress-bar-container\"], [\"color\", \"accent\", \"mode\", \"indeterminate\", 4, \"ngIf\"], [\"color\", \"accent\", \"mode\", \"indeterminate\"]],\n  template: function LayoutComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r10 = i0.ɵɵgetCurrentView();\n\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"mat-toolbar\", 1)(2, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function LayoutComponent_Template_button_click_2_listener() {\n        i0.ɵɵrestoreView(_r10);\n\n        const _r4 = i0.ɵɵreference(33);\n\n        return i0.ɵɵresetView(_r4.toggle());\n      });\n      i0.ɵɵelementStart(3, \"mat-icon\");\n      i0.ɵɵtext(4, \"menu\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"a\", 3)(6, \"h1\");\n      i0.ɵɵtext(7, \"SHOG.AI\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(8, \"span\", 4);\n      i0.ɵɵelementStart(9, \"button\", 5)(10, \"mat-icon\", 6);\n      i0.ɵɵtext(11, \" notifications \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"mat-menu\", 7, 8)(14, \"a\", 9)(15, \"mat-icon\");\n      i0.ɵɵtext(16, \"event\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(17, LayoutComponent_span_17_Template, 2, 1, \"span\", 10);\n      i0.ɵɵtemplate(18, LayoutComponent_span_18_Template, 2, 0, \"span\", 10);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(19, \"button\", 11)(20, \"mat-icon\");\n      i0.ɵɵtext(21, \"person\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"span\", 12);\n      i0.ɵɵtext(23);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(24, \"mat-menu\", 7, 13)(26, \"button\", 14);\n      i0.ɵɵlistener(\"click\", function LayoutComponent_Template_button_click_26_listener() {\n        return ctx.onLogout();\n      });\n      i0.ɵɵelementStart(27, \"mat-icon\");\n      i0.ɵɵtext(28, \"exit_to_app\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(29, \"span\");\n      i0.ɵɵtext(30, \"Cerrar Sesi\\u00F3n\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(31, \"mat-sidenav-container\", 15)(32, \"mat-sidenav\", 16, 17)(34, \"mat-nav-list\")(35, \"a\", 18)(36, \"mat-icon\", 19);\n      i0.ɵɵtext(37, \"dashboard\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(38, \"p\", 20);\n      i0.ɵɵtext(39, \" Inicio \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(40, LayoutComponent_a_40_Template, 5, 2, \"a\", 21);\n      i0.ɵɵtemplate(41, LayoutComponent_a_41_Template, 5, 2, \"a\", 21);\n      i0.ɵɵtemplate(42, LayoutComponent_a_42_Template, 5, 2, \"a\", 21);\n      i0.ɵɵtemplate(43, LayoutComponent_a_43_Template, 5, 2, \"a\", 21);\n      i0.ɵɵelement(44, \"mat-divider\");\n      i0.ɵɵelementStart(45, \"a\", 22);\n      i0.ɵɵlistener(\"click\", function LayoutComponent_Template_a_click_45_listener() {\n        return ctx.onLogout();\n      });\n      i0.ɵɵelementStart(46, \"mat-icon\", 19);\n      i0.ɵɵtext(47, \"exit_to_app\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(48, \"p\", 20);\n      i0.ɵɵtext(49, \" Cerrar Sesi\\u00F3n \");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(50, \"mat-sidenav-content\", 23)(51, \"div\", 24);\n      i0.ɵɵtemplate(52, LayoutComponent_mat_progress_bar_52_Template, 1, 0, \"mat-progress-bar\", 25);\n      i0.ɵɵpipe(53, \"async\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(54, \"router-outlet\");\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(13);\n\n      const _r3 = i0.ɵɵreference(25);\n\n      i0.ɵɵclassProp(\"example-is-mobile\", ctx.mobileQuery.matches);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(23, _c4));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"matMenuTriggerFor\", _r0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matBadge\", ctx.notificacionesCount)(\"matBadgeHidden\", ctx.notificacionesCount === 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"overlapTrigger\", false);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", ctx.notificacionesCount > 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.notificacionesCount === 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matMenuTriggerFor\", _r3);\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(ctx.userName);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"overlapTrigger\", false);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"opened\", !ctx.mobileQuery.matches)(\"mode\", ctx.mobileQuery.matches ? \"over\" : \"side\")(\"fixedInViewport\", ctx.mobileQuery.matches);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(24, _c5));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", ctx.esAdmin || ctx.esOperador || ctx.esCalificador);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.esAdmin || ctx.esOperador);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.esAdmin || ctx.esCalificador);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.esAdmin);\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(53, 21, ctx.spinnerService.visibility));\n    }\n  },\n  dependencies: [i6.RouterOutlet, i6.RouterLinkWithHref, i6.RouterLinkActive, i7.NgIf, i8.MatSidenav, i8.MatSidenavContainer, i8.MatSidenavContent, i9.MatIcon, i10.MatToolbar, i11.MatButton, i12.MatNavList, i12.MatListItem, i13.MatLine, i12.MatListIconCssMatStyler, i14.MatDivider, i15.MatProgressBar, i16.MatMenu, i16.MatMenuItem, i16.MatMenuTrigger, i17.MatTooltip, i18.MatBadge, i19.DefaultShowHideDirective, i7.AsyncPipe],\n  styles: [\".navbar-spacer[_ngcontent-%COMP%] {\\r\\n  flex: 1 1 auto;\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%] {\\r\\n  z-index: 2;\\r\\n}\\r\\n\\r\\n.navbar-brand[_ngcontent-%COMP%] {\\r\\n  text-decoration: none;\\r\\n  color: white;\\r\\n}\\r\\n\\r\\n.navbar-container[_ngcontent-%COMP%] {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  bottom: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n}\\r\\n\\r\\n.navbar-is-mobile[_ngcontent-%COMP%]   .navbar[_ngcontent-%COMP%] {\\r\\n  position: fixed;\\r\\n  \\r\\n  z-index: 2;\\r\\n}\\r\\n\\r\\n.navbar-sidenav-container[_ngcontent-%COMP%] {\\r\\n  \\r\\n  flex: 1;\\r\\n}\\r\\n\\r\\n.navbar-is-mobile[_ngcontent-%COMP%]   .navbar-sidenav-container[_ngcontent-%COMP%] {\\r\\n  \\r\\n  flex: 1 0 auto;\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\nmat-sidenav[_ngcontent-%COMP%] {\\r\\n  min-width: 180px !important;\\r\\n  border-right: 1px solid #eee;\\r\\n  box-shadow: 6px 0 6px rgba(0, 0, 0, .1);\\r\\n  \\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n.progress-bar-container[_ngcontent-%COMP%] {\\r\\n  height: 5px;\\r\\n}\\r\\n\\r\\na.mat-list-item.active[_ngcontent-%COMP%] {\\r\\n  background: rgba(0, 0, 0, .04);\\r\\n}\\r\\n\\r\\n#push-bottom[_ngcontent-%COMP%] {\\r\\n  position: absolute;\\r\\n  bottom: 0;\\r\\n}\\r\\n\\r\\nmat-toolbar[_ngcontent-%COMP%]{\\r\\n  background-color: #41dedd\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxheW91dC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTtFQUNFLFVBQVU7QUFDWjs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLGtCQUFrQjtFQUNsQixNQUFNO0VBQ04sU0FBUztFQUNULE9BQU87RUFDUCxRQUFRO0FBQ1Y7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsOEVBQThFO0VBQzlFLFVBQVU7QUFDWjs7QUFFQTtFQUNFO2dHQUM4RjtFQUM5RixPQUFPO0FBQ1Q7O0FBRUE7RUFDRTtxRUFDbUU7RUFDbkUsY0FBYztBQUNoQjs7QUFFQSxvQkFBb0I7O0FBRXBCO0VBQ0UsMkJBQTJCO0VBQzNCLDRCQUE0QjtFQUM1Qix1Q0FBdUM7RUFDdkMsdUNBQXVDO0FBQ3pDOztBQUVBLGdFQUFnRTs7QUFFaEU7RUFDRSxXQUFXO0FBQ2I7O0FBRUE7RUFDRSw4QkFBOEI7QUFDaEM7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsU0FBUztBQUNYOztBQUVBO0VBQ0U7QUFDRiIsImZpbGUiOiJsYXlvdXQuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5uYXZiYXItc3BhY2VyIHtcclxuICBmbGV4OiAxIDEgYXV0bztcclxufVxyXG5cclxuLm5hdmJhciB7XHJcbiAgei1pbmRleDogMjtcclxufVxyXG5cclxuLm5hdmJhci1icmFuZCB7XHJcbiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gIGNvbG9yOiB3aGl0ZTtcclxufVxyXG5cclxuLm5hdmJhci1jb250YWluZXIge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgdG9wOiAwO1xyXG4gIGJvdHRvbTogMDtcclxuICBsZWZ0OiAwO1xyXG4gIHJpZ2h0OiAwO1xyXG59XHJcblxyXG4ubmF2YmFyLWlzLW1vYmlsZSAubmF2YmFyIHtcclxuICBwb3NpdGlvbjogZml4ZWQ7XHJcbiAgLyogTWFrZSBzdXJlIHRoZSB0b29sYmFyIHdpbGwgc3RheSBvbiB0b3Agb2YgdGhlIGNvbnRlbnQgYXMgaXQgc2Nyb2xscyBwYXN0LiAqL1xyXG4gIHotaW5kZXg6IDI7XHJcbn1cclxuXHJcbi5uYXZiYXItc2lkZW5hdi1jb250YWluZXIge1xyXG4gIC8qIFdoZW4gdGhlIHNpZGVuYXYgaXMgbm90IGZpeGVkLCBzdHJldGNoIHRoZSBzaWRlbmF2IGNvbnRhaW5lciB0byBmaWxsIHRoZSBhdmFpbGFibGUgc3BhY2UuIFRoaXNcclxuICAgICAgICAgICBjYXVzZXMgYDxtYXQtc2lkZW5hdi1jb250ZW50PmAgdG8gYWN0IGFzIG91ciBzY3JvbGxpbmcgZWxlbWVudCBmb3IgZGVza3RvcCBsYXlvdXRzLiAqL1xyXG4gIGZsZXg6IDE7XHJcbn1cclxuXHJcbi5uYXZiYXItaXMtbW9iaWxlIC5uYXZiYXItc2lkZW5hdi1jb250YWluZXIge1xyXG4gIC8qIFdoZW4gdGhlIHNpZGVuYXYgaXMgZml4ZWQsIGRvbid0IGNvbnN0cmFpbiB0aGUgaGVpZ2h0IG9mIHRoZSBzaWRlbmF2IGNvbnRhaW5lci4gVGhpcyBhbGxvd3MgdGhlXHJcbiAgICAgICAgICAgYDxib2R5PmAgdG8gYmUgb3VyIHNjcm9sbGluZyBlbGVtZW50IGZvciBtb2JpbGUgbGF5b3V0cy4gKi9cclxuICBmbGV4OiAxIDAgYXV0bztcclxufVxyXG5cclxuLypTZXQgc2lkZW5hdiB3aWR0aCovXHJcblxyXG5tYXQtc2lkZW5hdiB7XHJcbiAgbWluLXdpZHRoOiAxODBweCAhaW1wb3J0YW50O1xyXG4gIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNlZWU7XHJcbiAgYm94LXNoYWRvdzogNnB4IDAgNnB4IHJnYmEoMCwgMCwgMCwgLjEpO1xyXG4gIC8qIGJhY2tncm91bmQtY29sb3I6cmdiKDYzLCA4MSwgMTgxKTsgKi9cclxufVxyXG5cclxuLyogU2V0IGhlaWdodCBvZiB3cmFwcGVyIHRvIHN0b3AgY29udGVudCBmcm9tIG1vdmluZyB1cCAmIGRvd24gKi9cclxuXHJcbi5wcm9ncmVzcy1iYXItY29udGFpbmVyIHtcclxuICBoZWlnaHQ6IDVweDtcclxufVxyXG5cclxuYS5tYXQtbGlzdC1pdGVtLmFjdGl2ZSB7XHJcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAuMDQpO1xyXG59XHJcblxyXG4jcHVzaC1ib3R0b20ge1xyXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICBib3R0b206IDA7XHJcbn1cclxuXHJcbm1hdC10b29sYmFye1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICM0MWRlZGRcclxufSJdfQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["ChangeDetectorRef","timer","Subscription","i0","LayoutComponent","constructor","changeDetectorRef","media","spinnerService","authService","authGuard","reservaService","mobileQuery","matchMedia","_mobileQueryListener","detectChanges","addListener","ngOnInit","currentUser","getCurrentUser","user","isAdmin","userName","fullName","timer$","autoLogoutSubscription","subscribe","canActivate","cargarNotificaciones","ngOnDestroy","removeListener","unsubscribe","ngAfterViewInit","onLogout","logout","getConteoHoy","data","notificacionesCount","total","console","log","error","esAdmin","usuario","rol","esOperador","esCalificador","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["D:\\Nueva carpeta\\Shogai-internal\\ultimoAhoraSi\\src\\app\\shared\\layout\\layout.component.ts","D:\\Nueva carpeta\\Shogai-internal\\ultimoAhoraSi\\src\\app\\shared\\layout\\layout.component.html"],"sourcesContent":["import { Component, OnInit, ChangeDetectorRef, OnDestroy, AfterViewInit } from '@angular/core';\r\nimport { MediaMatcher } from '@angular/cdk/layout';\r\nimport { timer } from 'rxjs';\r\nimport { Subscription } from 'rxjs';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\n import { AuthenticationService } from 'src/app/core/services/auth.service';\r\nimport { SpinnerService } from '../../core/services/spinner.service';\r\nimport { AuthGuard } from 'src/app/core/guards/auth.guard';\r\nimport { ReservaService } from '../../core/services/reserva.service';\r\n\r\n@Component({\r\n    selector: 'app-layout',\r\n    templateUrl: './layout.component.html',\r\n    styleUrls: ['./layout.component.css']\r\n})\r\nexport class LayoutComponent implements OnInit, OnDestroy, AfterViewInit {\r\n\r\n    private _mobileQueryListener: () => void;\r\n    mobileQuery: MediaQueryList;\r\n    showSpinner: boolean = false;\r\n    userName: string = \"\";\r\n    isAdmin: boolean = false;\r\n    notificacionesCount: number = 0;\r\n    currentUser: any;\r\n\r\n    private autoLogoutSubscription: Subscription = new Subscription;\r\n\r\n    constructor(private changeDetectorRef: ChangeDetectorRef,\r\n        private media: MediaMatcher,\r\n        public spinnerService: SpinnerService,\r\n        private authService: AuthenticationService,\r\n        private authGuard: AuthGuard,\r\n    private reservaService: ReservaService) {\r\n\r\n        this.mobileQuery = this.media.matchMedia('(max-width: 1000px)');\r\n        this._mobileQueryListener = () => changeDetectorRef.detectChanges();\r\n        // tslint:disable-next-line: deprecation\r\n        this.mobileQuery.addListener(this._mobileQueryListener);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.currentUser = this.authService.getCurrentUser();\r\n        const user = this.authService.getCurrentUser();\r\n\r\n        this.isAdmin = user.isAdmin;\r\n        this.userName = user.fullName;\r\n\r\n        // Auto log-out subscription\r\n        const timer$ = timer(2000, 5000);\r\n        this.autoLogoutSubscription = timer$.subscribe(() => {\r\n            this.authGuard.canActivate();\r\n        });\r\n\r\n        this.cargarNotificaciones();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        // tslint:disable-next-line: deprecation\r\n        this.mobileQuery.removeListener(this._mobileQueryListener);\r\n        this.autoLogoutSubscription.unsubscribe();\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        this.changeDetectorRef.detectChanges();\r\n    }\r\n\r\n    onLogout() {\r\n        this.authService.logout(); \r\n        // Esta función ya se encarga de borrar el localStorage \r\n        // y redirigir al login.\r\n    }\r\n\r\n    cargarNotificaciones() {\r\n        this.reservaService.getConteoHoy().subscribe(\r\n            (data) => {\r\n                this.notificacionesCount = data.total;\r\n                console.log('Citas para hoy:', this.notificacionesCount);\r\n            },\r\n            (error) => console.error('Error cargando notificaciones', error)\r\n        );\r\n    }\r\n\r\n    get esAdmin() { return this.currentUser?.usuario?.rol === 'ADMIN'; }\r\n    get esOperador() { return this.currentUser?.usuario?.rol === 'OPERADOR'; }\r\n    get esCalificador() { return this.currentUser?.usuario?.rol === 'CALIFICADOR'; }\r\n}\r\n","<div class=\"navbar-container\" [class.example-is-mobile]=\"mobileQuery.matches\">\r\n\r\n  <!-- BARRA SUPERIOR (Navbar) -->\r\n  <mat-toolbar class=\"navbar\">\r\n    \r\n    <!-- Botón Hamburguesa (Menú) -->\r\n    <button mat-icon-button (click)=\"snav.toggle()\">\r\n      <mat-icon>menu</mat-icon>\r\n    </button>\r\n\r\n    <!-- Título / Logo -->\r\n    <a class=\"navbar-brand\" [routerLink]=\"['/']\" matTooltip=\"Home\">\r\n      <h1>SHOG.AI</h1>\r\n    </a>\r\n\r\n    <!-- Espaciador flexible -->\r\n    <span class=\"navbar-spacer\"></span>\r\n\r\n    <!-- --- ¡AQUÍ ESTÁ LA CAMPANITA DE NUEVO! --- -->\r\n    <button mat-icon-button [matMenuTriggerFor]=\"notificationMenu\">\r\n      <mat-icon \r\n        [matBadge]=\"notificacionesCount\" \r\n        [matBadgeHidden]=\"notificacionesCount === 0\" \r\n        matBadgeColor=\"warn\">\r\n        notifications\r\n      </mat-icon>\r\n    </button>\r\n    \r\n    <!-- Menú desplegable de la campana -->\r\n    <mat-menu #notificationMenu=\"matMenu\" xPosition=\"before\" yPosition=\"above\" [overlapTrigger]=\"false\">\r\n      <a mat-menu-item routerLink=\"/dashboard\">\r\n        <mat-icon>event</mat-icon>\r\n        <span *ngIf=\"notificacionesCount > 0\">Tienes {{ notificacionesCount }} citas para hoy</span>\r\n        <span *ngIf=\"notificacionesCount === 0\">No tienes citas pendientes</span>\r\n      </a>\r\n    </mat-menu>\r\n    <!-- ------------------------------------------- -->\r\n\r\n\r\n    <!-- Botón de Usuario -->\r\n    <button mat-button [matMenuTriggerFor]=\"userMenu\">\r\n      <mat-icon>person</mat-icon>\r\n      <span fxShow fxHide.xs>{{userName}}</span>\r\n    </button>\r\n    \r\n    <!-- Menú de Usuario -->\r\n    <mat-menu #userMenu=\"matMenu\" xPosition=\"before\" yPosition=\"above\" [overlapTrigger]=\"false\">\r\n      <!-- (Opcional) Perfil -->\r\n      <!-- <button mat-menu-item routerLink=\"/account\">\r\n        <mat-icon>person</mat-icon>\r\n        <span>Mi Perfil</span>\r\n      </button> -->\r\n\r\n      <button mat-menu-item (click)=\"onLogout()\">\r\n        <mat-icon>exit_to_app</mat-icon>\r\n        <span>Cerrar Sesión</span>\r\n      </button>\r\n    </mat-menu>\r\n\r\n  </mat-toolbar>\r\n\r\n  <!-- BARRA LATERAL (Sidenav) -->\r\n  <mat-sidenav-container class=\"navbar-sidenav-container\">\r\n    \r\n    <mat-sidenav #snav [opened]=\"!mobileQuery.matches\" [mode]=\"mobileQuery.matches ? 'over' : 'side'\"\r\n      [fixedInViewport]=\"mobileQuery.matches\" fixedTopGap=\"56\" class=\"sidenav\">\r\n\r\n      <mat-nav-list>\r\n        \r\n        <!-- 1. DASHBOARD (Todos) -->\r\n        <a mat-list-item [routerLink]=\"['/dashboard']\" routerLinkActive=\"active\">\r\n          <mat-icon mat-list-icon>dashboard</mat-icon>\r\n          <p mat-line> Inicio </p>\r\n        </a>\r\n\r\n        <!-- 2. PACIENTES (Admin y Operador) -->\r\n        <a mat-list-item [routerLink]=\"['/customers']\" routerLinkActive=\"active\" *ngIf=\"esAdmin || esOperador || esCalificador \">\r\n          <mat-icon mat-list-icon>people</mat-icon>\r\n          <p mat-line> Pacientes </p>\r\n        </a>\r\n\r\n        <!-- 3. RESERVAS (Admin y Operador) -->\r\n        <a mat-list-item [routerLink]=\"['/typography']\" routerLinkActive=\"active\" *ngIf=\"esAdmin || esOperador\">\r\n          <mat-icon mat-list-icon>calendar_today</mat-icon>\r\n          <p mat-line> Reservas </p>\r\n        </a>\r\n\r\n\r\n        <!-- 5. REPORTES (Admin y Calificador) -->\r\n        <a mat-list-item [routerLink]=\"['/icons']\" routerLinkActive=\"active\" *ngIf=\"esAdmin || esCalificador\">\r\n          <mat-icon mat-list-icon>assessment</mat-icon>\r\n          <p mat-line> Reportes </p>\r\n        </a>\r\n\r\n        <!-- 6. USUARIOS (Solo Admin) -->\r\n        <a mat-list-item [routerLink]=\"['/users']\" routerLinkActive=\"active\" *ngIf=\"esAdmin\">\r\n          <mat-icon mat-list-icon>manage_accounts</mat-icon>\r\n          <p mat-line> Usuarios </p>\r\n        </a>\r\n\r\n        <mat-divider></mat-divider>\r\n\r\n        <!-- LOGOUT (Todos) -->\r\n        <a mat-list-item (click)=\"onLogout()\" style=\"cursor: pointer;\">\r\n          <mat-icon mat-list-icon>exit_to_app</mat-icon>\r\n          <p mat-line> Cerrar Sesión </p>\r\n        </a>\r\n\r\n      </mat-nav-list>\r\n\r\n    </mat-sidenav>\r\n\r\n    <!-- CONTENIDO PRINCIPAL -->\r\n    <mat-sidenav-content class=\"sidenav-content\">\r\n      <div class=\"progress-bar-container\">\r\n        <mat-progress-bar color=\"accent\" mode=\"indeterminate\" *ngIf=\"spinnerService.visibility | async\">\r\n        </mat-progress-bar>\r\n      </div>\r\n      \r\n      <router-outlet></router-outlet>\r\n\r\n    </mat-sidenav-content>\r\n  </mat-sidenav-container>\r\n\r\n</div>"]},"metadata":{},"sourceType":"module"}